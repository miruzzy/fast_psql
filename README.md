# fast_psql

// Русская версия 

Данная библиотека предназначена для быстрой загрузки в СУБД PostgreSQL данных, используя запрос 'COPY'  и передачу буфера в бинарном формате.

Основные плюсы бибилиотеки:
1. Быстрая загрузка
2. Не теряются данные ( на примере double )

Библиотка написана на С++, что даёт возможность встаивать её в проекты не других языках программирования.

Функционал библиотеки скудный. Он реализован именно для загрузки данных,  поэтому множетво стандартных функций он не поддерживает.

-------------------------------------------------------------------
Как пользоваться библиотекой.

1. Подключите библиотеку 
#include "fast_psql.h"

2. Создайте экземпляр класса
В качестве параметра в функцию следует передавать размер буфера, который будет зарезервирован
fast_psql p(5000); 

3. Подключитесь к серверу
p.Connect(<host>, <port>,<dbname>, <user>, <password>);

4. Выполните команды, которые нужны для текущего подключения
p.Exec("create temp table tmptable( id serial, testdata text) ;");

5. Подготовьте 'COPY' запрос ( докуменатция https://www.postgresql.org/docs/9.6/sql-copy.html )
p.Prepare("COPY tmptable( testdata ) FROM STDIN (format binary); ");

6. Укажите количество столбцов  для добавления 
p.SetColumns(1);

7. Добавляйте данные 
7.1 Через функции
p.AddValue(<value>);
7.2 через стрелки
p << <value>;

8. В конце сохраните данные
p.Exec();

-------------------------------------------------------------------
Пример обработки ошибок:
if(p.Exec("create table testtable5 ( id serial, trtt text) "))
{
    qDebug()<<"true"<<p.LastQuery().c_str()<<p.LastError().c_str();
}
else
{
    qDebug()<<"false"<<p.LastQuery().c_str()<<p.LastError().c_str();
}

-------------------------------------------------------------------
Если используете процессор на архитектуре SPARС:
В файле 'fast_psql.cpp' расскоментируйте строку '//#define sparc'


В дальнейшем буду обновлять функционал программного обеспечения. Если что-то требуется - пишите мне.
